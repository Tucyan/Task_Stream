
---

## 1. 用户表（User）

| 字段名         | 类型         | 约束           | 说明         |
| -------------- | ------------ | -------------- | ------------ |
| id             | INTEGER      | PRIMARY KEY    | 用户ID       |
| username       | TEXT         | NOT NULL UNIQUE| 用户名       |
| created_at     | TEXT         | NOT NULL       | 创建时间     |
| name           | TEXT         |                | 昵称         |
| passwordHash   | TEXT         | NOT NULL       | 密码哈希值   |


---

### 2. 任务表（Task）

| 字段名              | 类型         | 约束           | 说明         |
| ------------------- | ------------ | -------------- | ------------ |
| id                  | INTEGER      | PRIMARY KEY    | 任务ID       |
| user_id             | INTEGER      | NOT NULL       | 用户ID（外键）|
| title               | TEXT         | NOT NULL       | 任务标题     |
| description         | TEXT         |                | 任务描述     |
| status              | INTEGER      | NOT NULL       | 状态（1:todo, 2:in_progress, 3:done）|
| due_date            | TEXT         |                | 截止时间"YYYY-MM-DD HH-MM"|
| created_at          | TEXT         | NOT NULL       | 创建时间     |
| updated_at          | TEXT         | NOT NULL       | 更新时间     |
| assigned_date       | TEXT         |                | 分配日期"YYYY-MM-DD"，默认为创建日期|
| assigned_start_time | TEXT         |                | 分配开始时间"HH-MM"|
| assigned_end_time   | TEXT         |                | 分配结束时间"HH-MM"|
| tags                | TEXT         |                | 标签（JSON字符串，最多3个，每个≤10字符）|
| record_result       | INTEGER      | DEFAULT 0      | 是否记录成果（0/1）|
| result              | TEXT         |                | 成果描述     |
| result_picture_url  | TEXT         |                | 成果图片URL（JSON字符串数组）|
| long_term_task_id   | INTEGER      |                | 关联的长期任务ID（外键）|

---

### 3. 长期任务表（LongTermTask）

| 字段名      | 类型         | 约束           | 说明         |
| ----------- | ------------ | -------------- | ------------ |
| id          | INTEGER      | PRIMARY KEY    | 长期任务ID   |
| user_id     | INTEGER      | NOT NULL       | 用户ID（外键）|
| title       | TEXT         | NOT NULL       | 长期任务标题 |
| description | TEXT         |                | 长期任务描述 |
| start_date  | TEXT         |                | 开始日期     |
| end_date    | TEXT         |                | 结束日期     |
| progress    | REAL         | NOT NULL       | 进度百分比（0.0~1.0）|
| created_at  | TEXT         | NOT NULL       | 创建时间     |
| sub_task_ids| TEXT         |                | 子任务ID和权重的字典（JSON格式: {"task_id": weight}，例如 {"1": 0.7, "2": 0.3}|


---

### 4. 日志表（Journal）

| 字段名   | 类型         | 约束           | 说明         |
| -------- | ------------ | -------------- | ------------ |
| date     | TEXT         | NOT NULL   | 日志日期（YYYY-MM-DD）|
| user_id  | INTEGER      | NOT NULL       | 用户ID（外键）|
| content  | TEXT         | NOT NULL       | 日志内容     |
| main_key |         | PRIMARY KEY(date, user_id) | 联合主键 |


---

### 5. AI助手消息表

| 字段名    | 类型         | 约束           | 说明         |
| --------- | ------------ | -------------- | ------------ |
| id        | INTEGER      | PRIMARY KEY    | 消息ID       |
| user_id   | INTEGER      | NOT NULL       | 用户ID（外键）|
| title     | TEXT         |                | 会话标题     |
| timestamp | TEXT         | NOT NULL       | 消息时间戳   |
| messages  | TEXT         | NOT NULL       | 消息内容（JSON字符串数组）|
---
## 6. 设置表（Settings）

| 字段名      | 类型     | 约束                | 说明                   |
| ----------- | -------- | ------------------- | ---------------------- |
| id          | INTEGER  | PRIMARY KEY         | 设置ID                 |
| user_id     | INTEGER  | NOT NULL            | 用户ID（外键）         |
| primary     | TEXT     | NOT NULL            | 强调色（HEX色值）      |
| bg          | TEXT     | NOT NULL            | 背景色（HEX色值）      |
| card        | TEXT     | NOT NULL            | 卡片色（HEX色值）      |
| text        | TEXT     | NOT NULL            | 文字色（HEX色值）      |
| theme_mode  | TEXT     | DEFAULT 'light'     | 主题模式（light/dark） |
